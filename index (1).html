<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theo d√µi t·∫≠p t√≠nh h√†ng ng√†y c·ªßa nai nu√¥i nh·ªët</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    body {
      min-height: 100vh;
      background-image:
        linear-gradient(135deg, rgba(6, 78, 59, 0.9), rgba(21, 128, 61, 0.9)),
        url("https://images.unsplash.com/photo-1516371535707-512a1e83bb9a?auto=format&fit=crop&w=1600&q=80");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color: #facc15; /* v√†ng */
    }

    ::placeholder {
      color: rgba(250, 204, 21, 0.6);
    }

    .glass-panel {
      background: rgba(6, 46, 34, 0.9);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(250, 204, 21, 0.25);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    }

    .scrollbar-thin::-webkit-scrollbar {
      height: 6px;
      width: 6px;
    }
    .scrollbar-thin::-webkit-scrollbar-track {
      background: rgba(15, 118, 110, 0.4);
    }
    .scrollbar-thin::-webkit-scrollbar-thumb {
      background-color: rgba(250, 204, 21, 0.6);
      border-radius: 999px;
    }

    table thead tr {
      background: rgba(6, 95, 70, 0.95);
    }
  </style>
</head>
<body class="font-sans">
  <div class="min-h-screen flex flex-col items-center justify-start px-4 py-6 md:py-10">
    <header class="w-full max-w-6xl mb-6 md:mb-8">
      <div class="glass-panel rounded-2xl px-5 py-4 md:px-8 md:py-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 class="text-2xl md:text-3xl font-extrabold tracking-wide text-yellow-300 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]">
            Theo d√µi t·∫≠p t√≠nh h√†ng ng√†y c·ªßa nai nu√¥i nh·ªët
          </h1>
          <p class="mt-2 text-sm md:text-base text-yellow-100/80 max-w-2xl">
            Ghi ch√©p chi ti·∫øt ho·∫°t ƒë·ªông, th·ªùi gian, kh·∫©u ph·∫ßn ƒÉn, v·ªã tr√≠ v√† t√¨nh tr·∫°ng s·ª©c kh·ªèe c·ªßa t·ª´ng c√° th·ªÉ nai. 
            D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr√™n tr√¨nh duy·ªát (localStorage) ƒë·ªÉ ti·ªán so s√°nh theo ng√†y.
          </p>
        </div>
        <div class="text-right text-xs md:text-sm text-yellow-100/70">
          <p class="font-semibold">Tr·∫°ng th√°i: <span id="statusText" class="text-emerald-200">S·∫µn s√†ng</span></p>
          <p id="lastSavedText" class="mt-1 text-yellow-100/60 text-[11px]"></p>
        </div>
      </div>
    </header>

    <main class="w-full max-w-6xl flex flex-col gap-6 md:gap-8">
      <!-- Form nh·∫≠p li·ªáu -->
      <section class="glass-panel rounded-2xl px-5 py-5 md:px-8 md:py-6">
        <h2 class="text-xl md:text-2xl font-bold mb-3 md:mb-4 flex items-center gap-2">
          <span class="text-2xl">ü¶å</span>
          <span>Nh·∫≠t k√Ω t·∫≠p t√≠nh trong ng√†y</span>
        </h2>
        <form id="logForm" class="space-y-4 text-sm md:text-base">
          <div class="grid gap-3 md:gap-4 md:grid-cols-4">
            <div class="flex flex-col gap-1">
              <label for="date" class="font-semibold">Ng√†y ghi nh·∫≠n</label>
              <input
                type="date"
                id="date"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
                required
              />
            </div>
            <div class="flex flex-col gap-1">
              <label for="timeBlock" class="font-semibold">Th·ªùi ƒëi·ªÉm</label>
              <select
                id="timeBlock"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
                required
              >
                <option value="" disabled selected>Ch·ªçn th·ªùi ƒëi·ªÉm</option>
                <option value="S√°ng s·ªõm (5h - 8h)">S√°ng s·ªõm (5h - 8h)</option>
                <option value="Bu·ªïi s√°ng (8h - 11h)">Bu·ªïi s√°ng (8h - 11h)</option>
                <option value="Bu·ªïi tr∆∞a (11h - 14h)">Bu·ªïi tr∆∞a (11h - 14h)</option>
                <option value="Bu·ªïi chi·ªÅu (14h - 17h)">Bu·ªïi chi·ªÅu (14h - 17h)</option>
                <option value="Chi·ªÅu t·ªëi (17h - 20h)">Chi·ªÅu t·ªëi (17h - 20h)</option>
                <option value="Ban ƒë√™m (20h - 5h)">Ban ƒë√™m (20h - 5h)</option>
              </select>
            </div>
            <div class="flex flex-col gap-1">
              <label for="activity" class="font-semibold">Ho·∫°t ƒë·ªông ch√≠nh</label>
              <select
                id="activity"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
                required
              >
                <option value="" disabled selected>Ch·ªçn ho·∫°t ƒë·ªông</option>
                <option value="ƒÇn u·ªëng">ƒÇn u·ªëng</option>
                <option value="U·ªëng n∆∞·ªõc">U·ªëng n∆∞·ªõc</option>
                <option value="Ngh·ªâ ng∆°i / N·∫±m">Ngh·ªâ ng∆°i / N·∫±m</option>
                <option value="Di chuy·ªÉn / ƒëi l·∫°i">Di chuy·ªÉn / ƒëi l·∫°i</option>
                <option value="Ch·∫£i l√¥ng / t·ª± v·ªá sinh">Ch·∫£i l√¥ng / t·ª± v·ªá sinh</option>
                <option value="T∆∞∆°ng t√°c v·ªõi nai kh√°c">T∆∞∆°ng t√°c v·ªõi nai kh√°c</option>
                <option value="H∆∞ng ph·∫•n / giao ph·ªëi">H∆∞ng ph·∫•n / giao ph·ªëi</option>
                <option value="B·∫•t th∆∞·ªùng (hung d·ªØ, c·∫Øn ph√°...)">B·∫•t th∆∞·ªùng (hung d·ªØ, c·∫Øn ph√°...)</option>
              </select>
            </div>
            <div class="flex flex-col gap-1">
              <label for="duration" class="font-semibold">Th·ªùi l∆∞·ª£ng (ph√∫t)</label>
              <input
                type="number"
                id="duration"
                min="0"
                step="5"
                placeholder="V√≠ d·ª•: 30"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              />
            </div>
          </div>

          <div class="grid gap-3 md:gap-4 md:grid-cols-3">
            <div class="flex flex-col gap-1">
              <label for="feed" class="font-semibold">Th·ª©c ƒÉn</label>
              <input
                type="text"
                id="feed"
                placeholder="V√≠ d·ª•: C·ªè voi 3kg + c√°m 0.5kg"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              />
            </div>
            <div class="flex flex-col gap-1">
              <label for="location" class="font-semibold">V·ªã tr√≠ trong chu·ªìng / khu nu√¥i</label>
              <select
                id="location"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              >
                <option value="" selected>Kh√¥ng x√°c ƒë·ªãnh / To√†n khu</option>
                <option value="Khu chu·ªìng trong nh√†">Khu chu·ªìng trong nh√†</option>
                <option value="S√¢n c√°t / n·ªÅn kh√¥">S√¢n c√°t / n·ªÅn kh√¥</option>
                <option value="B√£i c·ªè m·ªü">B√£i c·ªè m·ªü</option>
                <option value="Khu cho ƒÉn">Khu cho ƒÉn</option>
                <option value="G√≥c chu·ªìng / s√°t h√†ng r√†o">G√≥c chu·ªìng / s√°t h√†ng r√†o</option>
              </select>
            </div>
            <div class="flex flex-col gap-1">
              <label for="health" class="font-semibold">T√¨nh tr·∫°ng s·ª©c kh·ªèe</label>
              <select
                id="health"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              >
                <option value="B√¨nh th∆∞·ªùng" selected>B√¨nh th∆∞·ªùng</option>
                <option value="ƒÇn u·ªëng k√©m">ƒÇn u·ªëng k√©m</option>
                <option value="L·ªù ƒë·ªù / √≠t v·∫≠n ƒë·ªông">L·ªù ƒë·ªù / √≠t v·∫≠n ƒë·ªông</option>
                <option value="ƒêau ch√¢n / ƒëi l·∫°i kh√≥">ƒêau ch√¢n / ƒëi l·∫°i kh√≥</option>
                <option value="C√≥ d·∫•u hi·ªáu b·ªánh ƒë∆∞·ªùng h√¥ h·∫•p">C√≥ d·∫•u hi·ªáu b·ªánh ƒë∆∞·ªùng h√¥ h·∫•p</option>
                <option value="C√≥ v·∫øt th∆∞∆°ng / ch·∫£y m√°u">C√≥ v·∫øt th∆∞∆°ng / ch·∫£y m√°u</option>
              </select>
            </div>
          </div>

          <div class="flex flex-col gap-1">
            <label for="note" class="font-semibold">Ghi ch√∫ chi ti·∫øt</label>
            <textarea
              id="note"
              rows="2"
              placeholder="M√¥ t·∫£ c·ª• th·ªÉ h√†nh vi, t∆∞∆°ng t√°c v·ªõi con kh√°c, ph·∫£n ·ª©ng v·ªõi ng∆∞·ªùi chƒÉm s√≥c, m√¥i tr∆∞·ªùng..."
              class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
            ></textarea>
          </div>

          <div class="flex flex-col md:flex-row md:items-center justify-between gap-3 mt-2">
            <div class="flex flex-wrap items-center gap-2">
              <button
                type="submit"
                class="inline-flex items-center justify-center gap-2 rounded-lg bg-yellow-400 text-emerald-950 font-semibold px-4 py-2 text-sm md:text-base hover:bg-yellow-300 active:bg-yellow-500 transition-colors shadow-lg shadow-yellow-900/40"
              >
                <span>Th√™m b·∫£n ghi</span>
              </button>
              <button
                type="button"
                id="resetFormBtn"
                class="inline-flex items-center justify-center rounded-lg border border-yellow-300/60 text-yellow-100 px-3 py-2 text-xs md:text-sm hover:bg-yellow-300/10"
              >
                X√≥a d·ªØ li·ªáu tr√™n form
              </button>
            </div>
            <p class="text-[11px] md:text-xs text-yellow-100/70">
              G·ª£i √Ω: Ghi ch√©p nhi·ªÅu m·ªëc th·ªùi gian trong ng√†y cho c√πng m·ªôt c√° th·ªÉ ƒë·ªÉ ƒë√°nh gi√° chu k·ª≥ ho·∫°t ƒë·ªông, kh·∫©u ph·∫ßn ƒÉn v√† tr·∫°ng th√°i t√¢m l√Ω.
            </p>
          </div>
        </form>
      </section>

      <!-- B·ªô l·ªçc & th·ªëng k√™ nhanh -->
      <section class="grid gap-4 md:gap-6 md:grid-cols-[1.2fr,1fr]">
        <div class="glass-panel rounded-2xl px-5 py-4 md:px-6 md:py-5">
          <h2 class="text-lg md:text-xl font-bold mb-3 flex items-center gap-2">
            <span>üîé</span>
            <span>B·ªô l·ªçc quan s√°t</span>
          </h2>
          <div class="grid gap-3 md:grid-cols-3 text-sm">
            <div class="flex flex-col gap-1">
              <label for="filterDate" class="font-semibold">L·ªçc theo ng√†y</label>
              <input
                type="date"
                id="filterDate"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              />
            </div>
            <div class="flex flex-col gap-1">
              <label for="filterActivity" class="font-semibold">L·ªçc theo ho·∫°t ƒë·ªông</label>
              <select
                id="filterActivity"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              >
                <option value="">T·∫•t c·∫£ ho·∫°t ƒë·ªông</option>
                <option value="ƒÇn u·ªëng">ƒÇn u·ªëng</option>
                <option value="U·ªëng n∆∞·ªõc">U·ªëng n∆∞·ªõc</option>
                <option value="Ngh·ªâ ng∆°i / N·∫±m">Ngh·ªâ ng∆°i / N·∫±m</option>
                <option value="Di chuy·ªÉn / ƒëi l·∫°i">Di chuy·ªÉn / ƒëi l·∫°i</option>
                <option value="Ch·∫£i l√¥ng / t·ª± v·ªá sinh">Ch·∫£i l√¥ng / t·ª± v·ªá sinh</option>
                <option value="T∆∞∆°ng t√°c v·ªõi nai kh√°c">T∆∞∆°ng t√°c v·ªõi nai kh√°c</option>
                <option value="H∆∞ng ph·∫•n / giao ph·ªëi">H∆∞ng ph·∫•n / giao ph·ªëi</option>
                <option value="B·∫•t th∆∞·ªùng (hung d·ªØ, c·∫Øn ph√°...)">B·∫•t th∆∞·ªùng (hung d·ªØ, c·∫Øn ph√°...)</option>
              </select>
            </div>
            <div class="flex flex-col gap-1">
              <label for="filterHealth" class="font-semibold">L·ªçc theo s·ª©c kh·ªèe</label>
              <select
                id="filterHealth"
                class="rounded-lg border border-yellow-400/40 bg-emerald-950/60 px-3 py-2 text-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-300/80 focus:border-yellow-300"
              >
                <option value="">T·∫•t c·∫£</option>
                <option value="B√¨nh th∆∞·ªùng">B√¨nh th∆∞·ªùng</option>
                <option value="ƒÇn u·ªëng k√©m">ƒÇn u·ªëng k√©m</option>
                <option value="L·ªù ƒë·ªù / √≠t v·∫≠n ƒë·ªông">L·ªù ƒë·ªù / √≠t v·∫≠n ƒë·ªông</option>
                <option value="ƒêau ch√¢n / ƒëi l·∫°i kh√≥">ƒêau ch√¢n / ƒëi l·∫°i kh√≥</option>
                <option value="C√≥ d·∫•u hi·ªáu b·ªánh ƒë∆∞·ªùng h√¥ h·∫•p">C√≥ d·∫•u hi·ªáu b·ªánh ƒë∆∞·ªùng h√¥ h·∫•p</option>
                <option value="C√≥ v·∫øt th∆∞∆°ng / ch·∫£y m√°u">C√≥ v·∫øt th∆∞∆°ng / ch·∫£y m√°u</option>
              </select>
            </div>
          </div>
          <div class="flex flex-wrap items-center gap-2 mt-3 text-xs">
            <button
              id="clearFilterBtn"
              class="inline-flex items-center rounded-lg border border-yellow-300/60 text-yellow-100 px-3 py-1.5 hover:bg-yellow-300/10"
            >
              X√≥a b·ªô l·ªçc
            </button>
            <button
              id="clearAllBtn"
              class="inline-flex items-center rounded-lg border border-red-400/70 text-red-200 px-3 py-1.5 hover:bg-red-500/20"
            >
              X√≥a to√†n b·ªô d·ªØ li·ªáu (trong tr√¨nh duy·ªát)
            </button>
          </div>
        </div>

        <div class="glass-panel rounded-2xl px-5 py-4 md:px-6 md:py-5 text-sm">
          <h2 class="text-lg font-bold mb-3 flex items-center gap-2">
            <span>üìä</span>
            <span>Th·ªëng k√™ nhanh trong ng√†y ch·ªçn</span>
          </h2>
          <div id="summaryBox" class="space-y-2 text-yellow-100/90 text-xs md:text-sm">
            <p><span class="font-semibold">T·ªïng b·∫£n ghi:</span> <span id="totalLogs">0</span></p>
            <p><span class="font-semibold">S·ªë ho·∫°t ƒë·ªông ƒÉn u·ªëng:</span> <span id="eatCount">0</span></p>
            <p><span class="font-semibold">S·ªë ho·∫°t ƒë·ªông b·∫•t th∆∞·ªùng:</span> <span id="abnormalCount">0</span></p>
            <p><span class="font-semibold">T·ªïng th·ªùi l∆∞·ª£ng quan s√°t (ph√∫t, n·∫øu c√≥ nh·∫≠p):</span> <span id="totalDuration">0</span></p>
            <p class="mt-2 text-[11px] md:text-xs text-yellow-100/70">
              G·ª£i √Ω: N·∫øu s·ªë ho·∫°t ƒë·ªông b·∫•t th∆∞·ªùng tƒÉng ho·∫∑c th·ªùi gian ngh·ªâ ng∆°i gi·∫£m b·∫•t th∆∞·ªùng so v·ªõi c√°c ng√†y kh√°c, n√™n ki·ªÉm tra s·ª©c kh·ªèe, kh·∫©u ph·∫ßn v√† m√¥i tr∆∞·ªùng nu√¥i.
            </p>
          </div>
        </div>
      </section>

      <!-- B·∫£ng d·ªØ li·ªáu -->
      <section class="glass-panel rounded-2xl px-3 py-4 md:px-6 md:py-5">
        <div class="flex items-center justify-between mb-3 md:mb-4">
          <h2 class="text-lg md:text-xl font-bold flex items-center gap-2">
            <span>üìã</span>
            <span>Danh s√°ch b·∫£n ghi quan s√°t</span>
          </h2>
          <p class="text-[11px] md:text-xs text-yellow-100/70" id="recordCountText">0 b·∫£n ghi</p>
        </div>
        <div class="overflow-auto scrollbar-thin max-h-[420px] border border-yellow-400/30 rounded-xl bg-emerald-950/50">
          <table class="min-w-full text-xs md:text-sm">
            <thead class="text-yellow-100 uppercase text-[10px] md:text-xs">
              <tr>
                <th class="px-2 md:px-3 py-2 text-left">Ng√†y</th>
                <th class="px-2 md:px-3 py-2 text-left">Th·ªùi ƒëi·ªÉm</th>
                <th class="px-2 md:px-3 py-2 text-left">Ho·∫°t ƒë·ªông</th>
                <th class="px-2 md:px-3 py-2 text-left">Th·ªùi l∆∞·ª£ng (ph√∫t)</th>
                <th class="px-2 md:px-3 py-2 text-left">Th·ª©c ƒÉn</th>
                <th class="px-2 md:px-3 py-2 text-left">V·ªã tr√≠</th>
                <th class="px-2 md:px-3 py-2 text-left">S·ª©c kh·ªèe</th>
                <th class="px-2 md:px-3 py-2 text-left">Ghi ch√∫</th>
                <th class="px-2 md:px-3 py-2 text-center">Thao t√°c</th>
              </tr>
            </thead>
            <tbody id="logTableBody" class="divide-y divide-emerald-700/70 text-yellow-50/95">
              <!-- D√≤ng d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <script>
    const STORAGE_KEY = 'deer_behavior_logs_v1';

    const form = document.getElementById('logForm');
    const dateInput = document.getElementById('date');
    const timeBlockInput = document.getElementById('timeBlock');
    const activityInput = document.getElementById('activity');
    const durationInput = document.getElementById('duration');
    const feedInput = document.getElementById('feed');
    const locationInput = document.getElementById('location');
    const healthInput = document.getElementById('health');
    const noteInput = document.getElementById('note');

    const filterDateInput = document.getElementById('filterDate');
    const filterActivityInput = document.getElementById('filterActivity');
    const filterHealthInput = document.getElementById('filterHealth');

    const logTableBody = document.getElementById('logTableBody');
    const totalLogsSpan = document.getElementById('totalLogs');
    const eatCountSpan = document.getElementById('eatCount');
    const abnormalCountSpan = document.getElementById('abnormalCount');
    const totalDurationSpan = document.getElementById('totalDuration');
    const recordCountText = document.getElementById('recordCountText');
    const lastSavedText = document.getElementById('lastSavedText');
    const statusText = document.getElementById('statusText');

    const resetFormBtn = document.getElementById('resetFormBtn');
    const clearFilterBtn = document.getElementById('clearFilterBtn');
    const clearAllBtn = document.getElementById('clearAllBtn');

    let logs = [];

    function setTodayOnInputs() {
      const today = new Date().toISOString().slice(0, 10);
      if (!dateInput.value) dateInput.value = today;
      if (!filterDateInput.value) filterDateInput.value = today;
    }

    function loadLogs() {
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        logs = stored ? JSON.parse(stored) : [];
        if (!Array.isArray(logs)) logs = [];
      } catch (e) {
        logs = [];
      }
    }

    function saveLogs() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
        const now = new Date();
        lastSavedText.textContent = `L∆∞u l·∫ßn cu·ªëi: ${now.toLocaleString('vi-VN')}`;
      } catch (e) {
        console.error('Kh√¥ng th·ªÉ l∆∞u localStorage', e);
      }
    }

    function humanDate(dStr) {
      if (!dStr) return '';
      const [y, m, d] = dStr.split('-');
      return `${d}/${m}/${y}`;
    }

    function render() {
      const filterDate = filterDateInput.value;
      const filterActivity = filterActivityInput.value;
      const filterHealth = filterHealthInput.value;

      const filtered = logs.filter((log) => {
        if (filterDate && log.date !== filterDate) return false;
        if (filterActivity && log.activity !== filterActivity) return false;
        if (filterHealth && log.health !== filterHealth) return false;
        return true;
      });

      logTableBody.innerHTML = '';

      filtered.forEach((log, index) => {
        const tr = document.createElement('tr');
        tr.className = index % 2 === 0 ? 'bg-emerald-900/40' : 'bg-emerald-900/20';

        tr.innerHTML = `
          <td class="px-2 md:px-3 py-2 align-top whitespace-nowrap">${humanDate(log.date)}</td>
          <td class="px-2 md:px-3 py-2 align-top">${log.timeBlock}</td>
          <td class="px-2 md:px-3 py-2 align-top">${log.activity}</td>
          <td class="px-2 md:px-3 py-2 align-top text-center">${log.duration || ''}</td>
          <td class="px-2 md:px-3 py-2 align-top">${log.feed || ''}</td>
          <td class="px-2 md:px-3 py-2 align-top">${log.location || ''}</td>
          <td class="px-2 md:px-3 py-2 align-top text-xs">${log.health || ''}</td>
          <td class="px-2 md:px-3 py-2 align-top max-w-[180px] md:max-w-xs text-[11px]">${log.note || ''}</td>
          <td class="px-2 md:px-3 py-2 align-top text-center">
            <button
              data-id="${log.id}"
              class="delete-btn text-[10px] md:text-xs text-red-200 border border-red-400/70 rounded px-2 py-1 hover:bg-red-500/20"
            >
              X√≥a
            </button>
          </td>
        `;

        logTableBody.appendChild(tr);
      });

      // C·∫≠p nh·∫≠t th·ªëng k√™
      totalLogsSpan.textContent = filtered.length;
      recordCountText.textContent = `${filtered.length} b·∫£n ghi ƒë∆∞·ª£c hi·ªÉn th·ªã`;

      let eatCount = 0;
      let abnormalCount = 0;
      let totalDuration = 0;

      filtered.forEach((log) => {
        if (log.activity === 'ƒÇn u·ªëng') eatCount++;
        if (log.activity && log.activity.startsWith('B·∫•t th∆∞·ªùng')) abnormalCount++;
        if (log.duration) totalDuration += Number(log.duration) || 0;
      });

      eatCountSpan.textContent = eatCount;
      abnormalCountSpan.textContent = abnormalCount;
      totalDurationSpan.textContent = totalDuration;
    }

    function validateForm() {
      if (!dateInput.value) {
        alert('Vui l√≤ng ch·ªçn ng√†y.');
        return false;
      }
      if (!timeBlockInput.value) {
        alert('Vui l√≤ng ch·ªçn th·ªùi ƒëi·ªÉm quan s√°t.');
        return false;
      }
      if (!activityInput.value) {
        alert('Vui l√≤ng ch·ªçn ho·∫°t ƒë·ªông ch√≠nh.');
        return false;
      }
      if (durationInput.value && Number(durationInput.value) < 0) {
        alert('Th·ªùi l∆∞·ª£ng kh√¥ng ƒë∆∞·ª£c √¢m.');
        return false;
      }
      return true;
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (!validateForm()) return;

      const log = {
        id: Date.now().toString(36) + Math.random().toString(36).slice(2, 7),
        date: dateInput.value,
        timeBlock: timeBlockInput.value,
        activity: activityInput.value,
        duration: durationInput.value ? Number(durationInput.value) : null,
        feed: feedInput.value.trim(),
        location: locationInput.value,
        health: healthInput.value,
        note: noteInput.value.trim(),
        createdAt: new Date().toISOString(),
      };

      logs.push(log);
      saveLogs();
      render();

      statusText.textContent = 'ƒê√£ th√™m b·∫£n ghi m·ªõi';
      statusText.classList.remove('text-emerald-200');
      statusText.classList.add('text-yellow-200');
      setTimeout(() => {
        statusText.textContent = 'S·∫µn s√†ng';
        statusText.classList.remove('text-yellow-200');
        statusText.classList.add('text-emerald-200');
      }, 2500);

      // Gi·ªØ l·∫°i ng√†y & b·ªô l·ªçc, ch·ªâ x√≥a c√°c tr∆∞·ªùng kh√°c
      timeBlockInput.value = '';
      activityInput.value = '';
      durationInput.value = '';
      feedInput.value = '';
      locationInput.value = '';
      healthInput.value = 'B√¨nh th∆∞·ªùng';
      noteInput.value = '';
    });

    resetFormBtn.addEventListener('click', () => {
      timeBlockInput.value = '';
      activityInput.value = '';
      durationInput.value = '';
      feedInput.value = '';
      locationInput.value = '';
      healthInput.value = 'B√¨nh th∆∞·ªùng';
      noteInput.value = '';
    });

    filterDateInput.addEventListener('change', render);
    filterActivityInput.addEventListener('change', render);
    filterHealthInput.addEventListener('change', render);

    clearFilterBtn.addEventListener('click', () => {
      filterDateInput.value = '';
      filterActivityInput.value = '';
      filterHealthInput.value = '';
      render();
    });

    clearAllBtn.addEventListener('click', () => {
      if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô d·ªØ li·ªáu (ch·ªâ tr√™n tr√¨nh duy·ªát hi·ªán t·∫°i)?')) return;
      logs = [];
      saveLogs();
      render();
    });

    logTableBody.addEventListener('click', (e) => {
      const btn = e.target.closest('.delete-btn');
      if (!btn) return;
      const id = btn.getAttribute('data-id');
      if (!id) return;
      if (!confirm('X√≥a b·∫£n ghi n√†y?')) return;
      logs = logs.filter((log) => log.id !== id);
      saveLogs();
      render();
    });

    // Kh·ªüi t·∫°o
    setTodayOnInputs();
    loadLogs();
    render();
  </script>
</body>
</html>